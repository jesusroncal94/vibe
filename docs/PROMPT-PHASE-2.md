# Prompt for Claude Code Web — PHASE 2 (Advanced Documents)

> **Use AFTER completing Phase 1.**

---

## SESSION 2A — Rich previews + Advanced upload

Read CLAUDE.md and `docs/migration-plan.md` section "PHASE 2, Week 1".

### Multi-file upload
- Upload multiple files simultaneously
- Progress bar per file
- Processing queue that doesn't block the UI

### Rich inline previews in chat
- Images: expandable thumbnail (lightbox/dialog)
- PDF: render first page with react-pdf (@react-pdf/renderer or pdf.js), name, pages, size
- DOCX: preview of extracted text (first ~500 chars) preserving headings
- XLSX: table preview (first 10 rows, max 6 columns), sheet selector
- CSV/TSV: inline table preview, auto-detect delimiter
- Code files: syntax highlighted (first ~30 lines), name, language, lines
- Markdown: rendered preview

### Improved processing
- PDF with OCR for scanned PDFs (tesseract.js)
- DOCX: extract tables in addition to text
- XLSX: detect headers, types, data ranges
- Images: auto-resize if > 5MB (sharp), convert to WebP
- ZIP: list contents, extract text files
- Encoding detection for non-UTF8 files

---

## SESSION 2B — Document generation

Read `docs/migration-plan.md` section "PHASE 2, Week 2".

### Automatic detection in Claude responses
- Code blocks with filename → "Download as file" button
- Markdown tables → "Download as XLSX" button
- Mermaid diagrams → render inline (mermaid.js) + "Download as SVG/PNG"
- JSON/YAML → "Download as file"

### Explicit generation
- "Generate a report" → formatted DOCX (docx-js): headings, tables, page numbers
- "Generate a spreadsheet" → formatted XLSX (ExcelJS): bold headers, auto-width
- "Generate a PDF" → formatted PDF (jsPDF or puppeteer)
- Each generation shows a download button inline in chat

### Conversation export
- Export as Markdown (.md)
- Export as PDF (full formatted conversation)
- Export as DOCX
- Button in conversation header: "Export ▾"

---

## SESSION 2C — File management + Lateral panel

Read `docs/migration-plan.md` section "PHASE 2, Week 3".

### File gallery (/files)
- Grid/list view toggle of all files
- Filters: by type, by conversation, by date
- Search by name
- Bulk delete
- Reuse file: select from gallery to attach to new conversation
- Storage stats: space used, files by type (simple chart)

### Lateral panel (Productivity layout)
- Right panel with files from the current conversation
- Click on file → expanded preview
- History of files generated by Claude in this conversation
- Drag file from panel to input → attach

### tRPC routers for files
- files.upload → process + store + metadata
- files.list → with filters and pagination
- files.get → download
- files.delete → delete + cleanup storage
- files.preview → data for inline preview
- files.generate → generate DOCX/XLSX/PDF from content
- files.export → export conversation

Verify end-to-end: upload scanned PDF → OCR → Claude reads it → ask for DOCX report → download → export conversation as PDF.
